<!doctype html>

<html>
	<head>
		<title>WebScoket Test</title>
		<style>
			
		</style>
	</head>
</html>

<script>
	var socket;
	console.log(document.cookie);
	
	function Connect()
	{
		
		socket = new WebSocket("ws://trirozhka.ru:3389");

		socket.onopen = function()
		{
			document.getElementById('sys_message').innerText="Connected";
		}
		
		socket.onmessage = function(message)
		{
			var json = JSON.parse(message.data);
			console.log(json);
			switch(json.type)
			{
				case 'show':
					document.getElementById('sys_message').innerText=json.mess;
					break;

				case 'saved':
					document.getElementById('sys_message').innerText=json.mess;
					break;
			}
		};
	}
	
	function Disconnect()
	{
		socket.close();
		document.getElementById('sys_message').innerText="Disconnected";
	}
	
	function Increase(anon)
	{
		var obj = {type: 'increase', anon:anon};
		var json = JSON.stringify(obj);
		socket.send(json);
	}
	
	function Decrease(anon)
	{
		var obj = {type: 'decrease', anon:anon};
		var json = JSON.stringify(obj);
		socket.send(json);
	}

	function SaveToDB()
	{
		var date = new Date();
		var obj = {type: 'save_db', date: date};
		var json = JSON.stringify(obj);
		socket.send(json);
	}

	function LoadDB()
	{

	}
			

</script>

<body>
	<form action="">
		<p id="sys_message">Push the button</p>
		<input type="button" value="Connect" onclick="Connect()">
		<input type="button" value="Increase Counter" onclick="Increase(false)">
		<input type="button" value="Increase Anonymously" onclick="Increase(true)">
		<input type="button" value="Decrease Anonymously" onclick="Decrease(true)">
		<input type="button" value="Decrease Counter" onclick="Decrease(false)">
		<input type="button" value="Disconnect" onclick="Disconnect()">
		<input type="button" value="Save to DB" onclick="SaveToDB()">
		<input type="button" value="Load From DB" onclick="LoadDB()">
	</form>
</body>
